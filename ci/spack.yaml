spack:
  specs:
  - fftw@3 +openmp ~mpi
  - cuda@12
  - gsl
  - flex
  - bison
  - python@3.11
  - py-pip
  - gperftools
  - intel-oneapi-tbb
  - meson
  
  concretizer:
    unify: true

  container:
    images:
      os: rockylinux:8
      spack: '0.22'

    strip: false

    # os_packages:
    #   final:
    #     - libgomp

    labels:
      app: abacus

  # only needed to provide LD_LIBRARY_PATH
  # will go away with meson/cmake Abacus build
  modules:
    prefix_inspections:
      ./bin:
        - PATH
      ./lib:
        - LD_LIBRARY_PATH
      ./lib64:
        - LD_LIBRARY_PATH
      ./man:
        - MANPATH
      ./share/man:
        - MANPATH
      ./share/aclocal:
        - ACLOCAL_PATH
      ./lib/pkgconfig:
        - PKG_CONFIG_PATH
      ./lib64/pkgconfig:
        - PKG_CONFIG_PATH
      ./share/pkgconfig:
        - PKG_CONFIG_PATH
      ./:
        - CMAKE_PREFIX_PATH
